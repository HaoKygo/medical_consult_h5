import{d as H,r as D,l as J,E as K,a as Q,o as i,e as p,c as t,h as a,t as h,A as X,u as o,w as n,i as s,k as w,s as v,v as Y,y as Z,p as ee,f as te}from"./index-2c594688.js";import{S as oe}from"./index-45fe1ee9.js";import{_ as ae}from"./McPaySheet-10aae55e.js";import{u as le,a as ne,P as se}from"./useDeleteConsultOrder-451b12ff.js";import{C as ue,t as ie,f as re}from"./constants-5b74f993.js";import{C as de}from"./index-d2e655e9.js";import{C as ce}from"./index-89e8d47e.js";import{_ as pe}from"./McNavBar-e9a11ba5.js";import{_ as ve}from"./avatar-doctor-b295eb9f.js";import{O as _}from"./index-5ddd6c15.js";import{d as _e}from"./consult-81e986b5.js";import{a as me}from"./index-c90de94a.js";import{s as fe,a as ye}from"./request-4ce71363.js";import{u as he}from"./useShowPrescription-89ecdc7e.js";import{I as Ce}from"./index-0e510418.js";import{B as ge}from"./index-b8156ae8.js";import{_ as we}from"./plugin-vueexport-helper-c27b6911.js";import"./index-7343e15d.js";import"./McIcon-f71b7353.js";import"./use-route-1b5f7a55.js";import"./use-placeholder-9dd8531a.js";import"./interceptor-063c6e58.js";import"./function-call-724adbfa.js";import"./index-762ae6d7.js";const C=g=>(ee("data-v-dad7fda5"),g=g(),te(),g),ke={key:0,class:"consult-detail-page"},Ie={class:"detail-head"},$e={class:"text"},De=C(()=>a("p",{class:"tip"},"服务医生信息",-1)),Pe={class:"card"},Se=C(()=>a("img",{class:"avatar",src:ve,alt:"doctor avatar"},null,-1)),be={class:"doctor"},xe=C(()=>a("span",null,"极速问诊",-1)),Oe={class:"detail-patient"},Te={class:"detail-order"},Be=C(()=>a("h3",null,"订单信息",-1)),Ne={key:0,class:"detail-time"},Ve={key:1,class:"detail-action van-hairline--top"},Fe={class:"price"},We=C(()=>a("span",null,"需付款",-1)),Me={key:2,class:"detail-action van-hairline--top"},Ee={key:3,class:"detail-action van-hairline--top"},Le={key:4,class:"detail-action van-hairline--top"},Re={class:"more"},Ue={key:5,class:"detail-action van-hairline--top"},ze={key:1,class:"consult-detail-page"},Ae=H({__name:"ConsultDetail",setup(g){const F=Y(),W=Z(),e=D();J(async()=>{const u=await _e(W.params.id);e.value=u});const{copy:M,copied:P,isSupported:E}=me(),L=()=>{var u;if(!E.value)return fe("未授权，不支持复制");M(((u=e.value)==null?void 0:u.orderNo)||"")};K(P,()=>{P.value&&ye("已复制")});const k=D(!1),{cancelLoading:I,cancelConsultOrder:S}=le(),{deleteLoading:b,deleteConsultOrder:x}=ne(F.back),{showPrescription:O}=he(),R=()=>{var u;(u=e.value)!=null&&u.countdown&&(e.value.countdown=0)},T=D(!1),U=Q(()=>{var u;return[{text:"查看处方",disabled:!((u=e.value)!=null&&u.prescriptionId)},{text:"删除订单"}]}),z=(u,l)=>{var m;l===0&&O((m=e.value)==null?void 0:m.prescriptionId),l===1&&x(e.value)};return(u,l)=>{var V;const m=pe,A=Ce,c=ce,B=de,G=ue,r=ge,j=se,q=ae,N=oe;return e.value?(i(),p("div",ke,[t(m,{middleTitle:"问诊详情"}),a("div",Ie,[a("div",$e,[a("h3",null,"图文问诊 "+h(e.value.payment)+" 元",1),a("span",{class:X(["status green",{orange:e.value.status===o(_).ConsultPayWait,green:e.value.status===o(_).ConsultChat}])},h(e.value.statusValue),3),De]),a("div",Pe,[Se,a("p",be,[xe,a("span",null,h((V=e.value.docInfo)==null?void 0:V.name),1)]),t(A,{name:"arrow"})])]),a("div",Oe,[t(B,{border:!1},{default:n(()=>{var d,f;return[t(c,{title:"患者信息",value:`${e.value.patientInfo.name} | ${e.value.patientInfo.genderValue} | ${e.value.patientInfo.age}岁`},null,8,["value"]),t(c,{title:"患病时长",value:(d=o(ie).find($=>{var y;return $.value===((y=e.value)==null?void 0:y.illnessTime)}))==null?void 0:d.label},null,8,["value"]),t(c,{title:"就诊情况",value:(f=o(re).find($=>{var y;return $.value===((y=e.value)==null?void 0:y.consultFlag)}))==null?void 0:f.label},null,8,["value"]),t(c,{title:"病情描述",label:e.value.illnessDesc},null,8,["label"])]}),_:1})]),a("div",Te,[Be,t(B,{border:!1},{default:n(()=>[t(c,{title:"订单编号"},{value:n(()=>[a("span",{class:"copy",onClick:L},"复制"),s(" "+h(e.value.orderNo),1)]),_:1}),t(c,{title:"创建时间",value:e.value.createTime},null,8,["value"]),t(c,{title:"应付款",value:`￥${e.value.payment}`},null,8,["value"]),e.value.couponDeduction?(i(),w(c,{key:0,title:"优惠券",value:`-￥${e.value.couponDeduction}`},null,8,["value"])):v("",!0),e.value.pointDeduction?(i(),w(c,{key:1,title:"积分抵扣",value:`-￥${e.value.pointDeduction}`},null,8,["value"])):v("",!0),t(c,{title:"实付款",value:`￥${e.value.actualPayment}`,class:"price"},null,8,["value"])]),_:1})]),e.value.status===o(_).ConsultPayWait&&e.value.countdown?(i(),p("div",Ne,[s(" 请在 "),t(G,{time:e.value.countdown*1e3,onFinish:R},null,8,["time"]),s(" 内完成支付，超时订单将取消 ")])):v("",!0),e.value.status===o(_).ConsultPayWait?(i(),p("div",Ve,[a("div",Fe,[We,a("span",null,h(`¥${e.value.payment}`),1)]),t(r,{type:"default",loading:o(I),onClick:l[0]||(l[0]=d=>o(S)(e.value)),round:""},{default:n(()=>[s(" 取消问诊 ")]),_:1},8,["loading"]),t(r,{onClick:l[1]||(l[1]=d=>k.value=!0),type:"primary",round:""},{default:n(()=>[s(" 继续支付 ")]),_:1})])):v("",!0),e.value.status===o(_).ConsultWait?(i(),p("div",Me,[t(r,{loading:o(I),onClick:l[2]||(l[2]=d=>o(S)(e.value)),type:"default",round:""},{default:n(()=>[s(" 取消问诊 ")]),_:1},8,["loading"]),t(r,{to:`/room?orderId=${e.value.id}`,type:"primary",round:""},{default:n(()=>[s(" 继续沟通 ")]),_:1},8,["to"])])):v("",!0),e.value.status===o(_).ConsultChat?(i(),p("div",Ee,[t(r,{onClick:l[3]||(l[3]=d=>{var f;return o(O)((f=e.value)==null?void 0:f.prescriptionId)}),type:"default",loading:o(I),round:""},{default:n(()=>[s(" 查看处方 ")]),_:1},8,["loading"]),t(r,{to:`/room?orderId=${e.value.id}`,type:"primary",round:""},{default:n(()=>[s(" 继续沟通 ")]),_:1},8,["to"])])):v("",!0),e.value.status===o(_).ConsultComplete?(i(),p("div",Le,[a("div",Re,[t(j,{actions:o(U),onSelect:z,placement:"top-start",show:T.value,"onUpdate:show":l[4]||(l[4]=d=>T.value=d)},{reference:n(()=>[s("更多")]),_:1},8,["actions","show"])]),t(r,{loading:o(b),to:`/room?orderId=${e.value.id}`,type:"default",round:""},{default:n(()=>[s(" 问诊记录 ")]),_:1},8,["loading","to"]),e.value.evaluateId?(i(),w(r,{key:1,to:`/room?orderId=${e.value.id}`,type:"default",round:""},{default:n(()=>[s(" 查看评价 ")]),_:1},8,["to"])):(i(),w(r,{key:0,to:`/room?orderId=${e.value.id}`,type:"primary",round:""},{default:n(()=>[s(" 去评价 ")]),_:1},8,["to"]))])):v("",!0),e.value.status===o(_).ConsultCancel?(i(),p("div",Ue,[t(r,{loading:o(b),onClick:l[5]||(l[5]=d=>o(x)(e.value)),type:"default",round:""},{default:n(()=>[s(" 删除订单 ")]),_:1},8,["loading"]),t(r,{to:"/home",type:"primary",round:""},{default:n(()=>[s("咨询其他医生")]),_:1})])):v("",!0),t(q,{show:k.value,"onUpdate:show":l[6]||(l[6]=d=>k.value=d),orderId:e.value.id,actualPayment:e.value.payment},null,8,["show","orderId","actualPayment"])])):(i(),p("div",ze,[t(m,{middleTitle:"问诊详情"}),t(N,{title:"",row:4,style:{"margin-top":"30px"}}),t(N,{title:"",row:4,style:{"margin-top":"30px"}})]))}}});const _t=we(Ae,[["__scopeId","data-v-dad7fda5"]]);export{_t as default};
