import{p as _,b as F,P as K,m as R,c as I}from"./request-985d172c.js";import{d as L,r as U,D as p,c as o,m as S,O as M}from"./index-62acf543.js";import{B as v}from"./index-1325795a.js";import{A as k,a as z}from"./index-862f48e9.js";import{c as W,e as m,n as G,H as V,h as j,t as P,G as q,C as J,K as T,L as Q,M as X,N as Y,f as Z}from"./index-99c93d2d.js";import{c as $}from"./interceptor-bf3a5363.js";const[ee,a,f]=W("dialog"),te=m({},_,{title:String,theme:String,width:G,message:[String,Function],callback:Function,allowHtml:Boolean,className:V,transition:j("van-dialog-bounce"),messageAlign:String,closeOnPopstate:P,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:P,closeOnClickOverlay:Boolean}),ne=[...F,"transition","closeOnPopstate"];var oe=L({name:ee,props:te,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:r,slots:l}){const u=U(),i=p({confirm:!1,cancel:!1}),C=t=>r("update:show",t),b=t=>{var n;C(!1),(n=e.callback)==null||n.call(e,t)},y=t=>()=>{e.show&&(r(t),e.beforeClose?(i[t]=!0,$(e.beforeClose,{args:[t],done(){b(t),i[t]=!1},canceled(){i[t]=!1}})):b(t))},B=y("cancel"),g=y("confirm"),x=M(t=>{var n,c;if(t.target!==((c=(n=u.value)==null?void 0:n.popupRef)==null?void 0:c.value))return;({Enter:e.showConfirmButton?g:T,Escape:e.showCancelButton?B:T})[t.key](),r("keydown",t)},["enter","esc"]),D=()=>{const t=l.title?l.title():e.title;if(t)return o("div",{class:a("header",{isolated:!e.message&&!l.default})},[t])},O=t=>{const{message:n,allowHtml:c,messageAlign:s}=e,d=a("message",{"has-title":t,[s]:s}),h=Q(n)?n():n;return c&&typeof h=="string"?o("div",{class:d,innerHTML:h},null):o("div",{class:d},[h])},A=()=>{if(l.default)return o("div",{class:a("content")},[l.default()]);const{title:t,message:n,allowHtml:c}=e;if(n){const s=!!(t||l.title);return o("div",{key:c?1:0,class:a("content",{isolated:!s})},[O(s)])}},E=()=>o("div",{class:[Y,a("footer")]},[e.showCancelButton&&o(v,{size:"large",text:e.cancelButtonText||f("cancel"),class:a("cancel"),style:{color:e.cancelButtonColor},loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(v,{size:"large",text:e.confirmButtonText||f("confirm"),class:[a("confirm"),{[X]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]),N=()=>o(z,{class:a("footer")},{default:()=>[e.showCancelButton&&o(k,{type:"warning",text:e.cancelButtonText||f("cancel"),class:a("cancel"),color:e.cancelButtonColor,loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(k,{type:"danger",text:e.confirmButtonText||f("confirm"),class:a("confirm"),color:e.confirmButtonColor,loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]}),H=()=>l.footer?l.footer():e.theme==="round-button"?N():E();return()=>{const{width:t,title:n,theme:c,message:s,className:d}=e;return o(K,S({ref:u,role:"dialog",class:[a([c]),d],style:{width:J(t)},tabindex:0,"aria-labelledby":n||s,onKeydown:x,"onUpdate:show":C},q(e,ne)),{default:()=>[D(),A(),H()]})}}});let w;const le={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let ae=m({},le);function ce(){({instance:w}=R({setup(){const{state:r,toggle:l}=I();return()=>o(oe,S(r,{"onUpdate:show":l}),null)}}))}function se(e){return Z?new Promise((r,l)=>{w||ce(),w.open(m({},ae,e,{callback:u=>{(u==="confirm"?r:l)(u)}}))}):Promise.resolve()}const Be=e=>se(m({showCancelButton:!0},e));export{se as a,Be as s};
